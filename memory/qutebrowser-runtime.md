<memory-metadata>
{
  "frequency": 66,
  "last_accessed_session": 592,
  "created_session": 0,
  "appreciation": 0,
  "pinned": true
}
</memory-metadata>

<conditional>
Recall if the user prompt mentions qutebrowser, --basedir, browser containerization, greasemonkey, userscripts, or the whale theme.
</conditional>

<fuzzy-match>
qutebrowser, --basedir, basedir, greasemonkey, whale theme, cssoverrides, IPC socket, qb
</fuzzy-match>

<memory>
Qutebrowser runs fully containerized via --basedir so all runtime state lives in one directory instead of scattering across XDG defaults.

## Default container

`~/.runtime/qutebrowser-yeyito/` — use this unless the user specifies a different one.

```bash
qutebrowser --basedir ~/.runtime/qutebrowser-yeyito
```

## Container directory structure

```
~/.runtime/qutebrowser-yeyito/
├── config/          # config.py, autoconfig.yml, quickmarks, bookmarks, greasemonkey, userscripts, whale theme
├── data/            # history.sqlite, sessions, state, cmd-history
│   └── webengine/   # Cookies, Local Storage, IndexedDB, Service Workers — ALL Chromium state
├── cache/           # HTTP cache, GPU cache, shader cache (expendable, regenerates)
│   └── webengine/
├── download/        # default download target
└── runtime/         # IPC socket (hashed by basedir, so instances don't collide)
```

## Config paths must be relative

In `config.py`, file paths (e.g. `content.user_stylesheets`) must use **relative paths** like `cssoverrides/default.css`, not absolute paths like `~/.config/qutebrowser/...`. Qutebrowser's `File` config type resolves relative paths against `standarddir.config()`, which `--basedir` redirects to the container's `config/` dir.

## config.py and key directories

`config.py` loads the `whale` theme module (lives in `config/whale/`), sources `permissions.py` for site-specific permissions (auto-generated by qutebrowser), and applies CSS overrides from `config/cssoverrides/`.

- `whale/` — Deep Ocean Blue color theme (custom)
- `greasemonkey/` — Greasemonkey userscripts
- `userscripts/` — Custom userscripts (invoked via `:spawn`)
- `cssoverrides/` — Per-site CSS override stylesheets
- `permissions.py` — Auto-generated site permissions (discord audio capture, etc.)

## How --basedir works internally

`qutebrowser/utils/standarddir.py` — `_from_args()` maps `QStandardPaths` location types to basedir subdirectories:
- ConfigLocation → `config/`
- AppDataLocation → `data/`
- CacheLocation → `cache/`
- DownloadLocation → `download/`
- RuntimeLocation → `runtime/`

IPC socket name is MD5-hashed by basedir, so multiple container instances are fully isolated.

## Qt ghost directories

Qt itself creates empty skeleton dirs at the default XDG locations on every launch:
- `~/.local/share/qutebrowser/qutebrowser/QtWebEngine/Default` (empty, from QWebEngineProfile constructor)
- `~/.cache/qutebrowser/qutebrowser/qtpipelinecache-*` (Qt RHI shader cache)

These contain no actual data — all real data goes to the basedir. This is a Qt-level behavior that happens before qutebrowser redirects paths. Cosmetic only.

## Backup

Original pre-containerization files backed up at: `~/Workspace/Playground/QutebrowserBackup/{config,data,cache}`

---
Update this memory when the container path changes, new containers are created, or config.py structure changes significantly.
</memory>
